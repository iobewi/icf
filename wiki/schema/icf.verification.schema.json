{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/iobewi/icf/main/doc/schema/icf.verification.schema.json",
  "title": "ICF Verification Report (CLI/App)",
  "type": "object",
  "properties": {
    "verified": {
      "type": "boolean",
      "description": "true if signature and policy checks passed"
    },
    "profile": {
      "type": "string",
      "enum": [
        "lite",
        "full"
      ],
      "description": "interpreted profile"
    },
    "authority_known": {
      "type": "boolean"
    },
    "authority_id": {
      "type": "string",
      "pattern": "^(?:[0-9A-Fa-f]{2}-){7}[0-9A-Fa-f]{2}$"
    },
    "failure_reason": {
      "type": "string",
      "enum": [
        "NONE",
        "FORMAT",
        "UNSUPPORTED_VERSION",
        "MISSING_SIGNATURE",
        "INVALID_SIGNATURE",
        "UNKNOWN_AUTHORITY",
        "HASH_MISMATCH",
        "EXPIRED",
        "E1_DECRYPT",
        "OTHER"
      ]
    },
    "checked_at": {
      "type": "string",
      "format": "date-time"
    }
  },
  "required": [
    "verified"
  ],
  "additionalProperties": false
}